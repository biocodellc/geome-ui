<Section class="validate-data">
    <div class="container">
        <div class="row">
            <div class="col-lg-12">
                <h3 class="valid-hed">Load Data</h3>
                <p class="valid-hed1">Data is subject to our <a class="valid-link" href="#">Data Usage Policy.</a></p>
            </div>
        </div>
        <div class="row">
            <ul ngbNav #nav="ngbNav" [(activeId)]="activeTab" class="nav-tabs">
                <li [ngbNavItem]="'load'">
                    <button ngbNavLink>{{ currentUser ? 'Load': 'Validate'}}</button>
                    <ng-template ngbNavContent>
                        <form>
                            <div class="row bottom-form-section">
                                <div class="input-section">
                                    <label class="input-label fastq-label">Data Type(s)</label>
                                    <div class="input-med-sec d-flex flex-wrap" style="column-gap: 1rem;">
                                        @for(type of allDataTypes; track type){
                                            <div class="form-check" [class.warn-text]="!checkedTypes.length">
                                                <input class="form-check-input" type="checkbox" id="flexCheckDefault_{{type.name}}" (change)="onCheckboxChange($event, type.name)" [checked]="selectedTypes.includes(type.name)">
                                                <label class="form-check-label" for="flexCheckDefault_{{type.name}}">
                                                    {{ type.name == 'Workbook' ? 'Excel ' + type.name : !type.name.includes('Fas') ? type.name + ' CSV' : type.name }}
                                                </label>
                                            </div>
                                        }
                                    </div>
                                </div>
                                @if(currentUser){
                                    <div class="input-section mt-2">
                                        <label class="input-label fastq-label"></label>
                                        <div class="input-med-sec d-flex flex-wrap" style="column-gap: 1rem;">
                                            <div class="form-check">
                                                <input class="form-check-input" name="validate" type="checkbox" id="flexCheckDefault_validate" [(ngModel)]="validateOnly">
                                                <label class="form-check-label fw-bold" for="flexCheckDefault_validate">Only Validate</label>
                                            </div>
                                        </div>
                                    </div>
                                }
                            </div>
    
                            @for(type of allDataTypes; track type){
                                @if(checkedTypes.includes(type.name) && !type.name.includes('Fas')){
                                    <app-upload [sectionData]="{ label: type.name }" (onFileChange)="handleWorksheetDataChange($event)"/>
                                }
                            }
    
                            @if(checkedTypes.includes("Fasta")){
                                <app-fasta-form  [config]="currentProject?.config" [fastaForm]="fastaData"/>
                            }

                            @if(checkedTypes.includes("Fastq")){
                                <app-fastq-form [config]="currentProject?.config" [fastqMetadataForm]="fastqMetadataForm" />
                            }
                    
                            @if(checkedTypes.includes("Fastq") || checkedTypes.includes("Fasta") || showExpeditions){
                                <div class="row bottom-form-section">
                                    <div class="col-lg-8">
                                        <div class="input-section">
                                            <label class="input-label fastq-label">Expedition Name</label>
                                            <div class="input-med-sec">
                                                <select class="form-select" (change)="onExpeditionChange($event)">
                                                    <option value="" selected>-- Select an Expedition --</option>
                                                    @if(multiExpeditionAllowed){
                                                        <option value="MULTI_EXPEDITION" selected>-- Multiple Expeditions --</option>
                                                    }
                                                    @for(expedition of allExpeditions; track expedition){
                                                        <option [value]="expedition.expeditionTitle">{{expedition.expeditionTitle}}</option>
                                                    }
                                                </select>
                                            </div>
                                            <button class="info-btn"><i class="fa-solid fa-plus"></i></button>
                                        </div>
                                    </div>
                                    <div class="col-lg-4"></div>
                                </div>
                            }

                            <div class="row mt-3">
                                <div class="col-8 d-flex justify-content-end">
                                    <button class="btn btn-primary custom" type="button" (click)="dataFormattingAndErrorCheck()">{{ validateOnly ? 'VALIDATE' : 'LOAD' }}</button>
                                </div>
                            </div>
                        </form>
                    </ng-template>
                </li>
                <li [ngbNavItem]="'results'">
                    <button ngbNavLink>Results</button>
                    <ng-template ngbNavContent>
                    </ng-template>
                </li>
            </ul>
            <div [ngbNavOutlet]="nav"></div>
        </div>

    </div>
</Section>