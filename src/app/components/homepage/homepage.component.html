<section id="homepage-container" class="main-content-container homepage-root" [ngClass]="{
  'prototype-story': activePrototype === 'story'
}">
  <div class="homepage-backdrop"></div>
  <div class="container py-4">
    <div class="prototype-toggle animate-in">
      <div class="toggle-intro">
        <p class="toggle-label">Homepage Prototypes</p>
        <p class="toggle-subtext">Bold visual concepts with quote-led messaging for field confidence and lab continuity.</p>
      </div>
      <div class="toggle-actions">
        <button type="button" class="toggle-btn" [class.active]="activePrototype === 'field'" (click)="setPrototype('field')">Prototype A</button>
        <button type="button" class="toggle-btn" [class.active]="activePrototype === 'ops'" (click)="setPrototype('ops')">Prototype B</button>
        <button type="button" class="toggle-btn" [class.active]="activePrototype === 'story'" (click)="setPrototype('story')">Prototype C</button>
      </div>
    </div>

    @if(activePrototype === 'field'){
      <section class="hero-shell hero-field animate-in">
        <div class="hero-orb hero-orb-a"></div>
        <div class="hero-copy">
          <p class="eyebrow">Prototype A | Immersive Field Signal</p>
          <h1>Capture once in the field. Trust it in the lab.</h1>
          <p class="hero-text">
            Built for teams where collecting events, samples, tissues, and sequences must stay connected as one narrative.
            <i class="fas fa-volume-high audio-icon" (click)="playAudio()"></i>
          </p>
          <div class="hero-quote-callout">
            <p>"Field data becomes scientific capital only when context survives the trip to analysis."</p>
          </div>
          <div class="hero-badges">
            <span>Full metadata provenance</span>
            <span>Persistent record identity</span>
            <span>Query-ready from day one</span>
          </div>
        </div>
        <div class="hero-art hero-art-field">
          <img src="images/geomeWorkflow.png" alt="GEOME workflow artwork">
          <div class="art-chip">Field campaign confidence</div>
        </div>
      </section>
    }
    @else if(activePrototype === 'ops'){
      <section class="hero-shell hero-ops animate-in">
        <div class="hero-orb hero-orb-b"></div>
        <div class="ops-left">
          <p class="eyebrow">Prototype B | Studio Operations Mode</p>
          <h1>High-visibility operations for collection teams and lab pipelines.</h1>
          <p class="hero-text">
            A vivid command-surface style concept focused on velocity, clarity, and controlled handoffs.
          </p>
          <div class="hero-quote-callout">
            <p>"Better metadata is not slower science. It is faster trustworthy science."</p>
          </div>
          <div class="hero-badges">
            <span>Expedition ownership visibility</span>
            <span>Validation before publication</span>
            <span>Reusable query intelligence</span>
          </div>
        </div>
        <div class="ops-right">
          <h4>Signal Strip</h4>
          <p class="ops-strip">COLLECT <span>-></span> VALIDATE <span>-></span> LINK <span>-></span> QUERY <span>-></span> PUBLISH</p>
          <img src="images/geomeRequired.png" alt="GEOME required fields artwork" class="ops-image">
        </div>
      </section>
    }
    @else{
      <section class="hero-shell hero-story animate-in">
        <article class="story-intro">
          <p class="story-kicker">Prototype C | White Story Theme</p>
          <h1 class="story-title">A field-to-lab story told in records, maps, and evidence-rich metadata.</h1>
          <p>
            GEOME supports expedition-scale organizing and lets teams move from collection narratives to searchable, reusable datasets.
            This concept uses a clean white editorial style inspired by long-form story pages, with stronger explanatory text and visual breaks.
          </p>
          <p>
            Researchers can establish context early, preserve interpretation of where and how samples were acquired, and trace connected entities through analysis pipelines.
            The goal is confidence: every downstream interpretation remains tethered to a clear field origin.
          </p>
        </article>

        <article class="story-flow flow-right">
          <figure class="story-float-media">
            <img [src]="geomeFigureTwo" alt="Figure 2 from Deck et al. 2017 showing GEOME query distribution map">
            <figcaption class="story-caption">Figure 2 (Deck et al. 2017): GEOME query map with distributed samples and locality context.</figcaption>
          </figure>
          <h3>Query Views That Keep Context Intact</h3>
          <p>
            Figure-driven map views help teams audit whether coverage and metadata quality match collection goals. This is critical when projects span
            sites, expeditions, and preservation protocols that can bias downstream interpretation if context is weak.
          </p>
          <p>
            In this prototype, the text wraps around the visual so users can read the story while still seeing the map evidence in view. The format is
            intended to communicate scientific confidence to both field teams and lab collaborators.
          </p>
        </article>

        <article class="story-flow flow-left">
          <figure class="story-float-media">
            <img [src]="featurePhotoOne" alt="Moorea coastline landscape">
          </figure>
          <h3>Field Reality, Not Just Metadata Tables</h3>
          <p>
            Collection environments are dynamic. A polished, readable homepage should communicate that GEOME is designed for real field constraints,
            while still producing records that are structured enough for rigorous lab and informatics workflows.
          </p>
          <p>
            Editorial layouts with image breaks improve scanability and present workflows as a continuous narrative instead of disconnected screens.
          </p>
        </article>

        <article class="story-flow story-research-intro">
          <h3>Research Stories Using GEOME</h3>
          <p>
            These literature examples cite the GEOME reference paper and show how scientists are using GEOME in biodiversity workflows,
            from observatory design and data stewardship to disease surveillance and FAIR metadata brokering.
          </p>
        </article>

        @for(story of geomeResearchStories; track story.title){
          <article class="story-flow story-research" [class.flow-left]="story.photoSide === 'left'" [class.flow-right]="story.photoSide !== 'left'">
            <figure class="story-float-media story-research-media">
              <img [src]="story.imageUrl" [alt]="story.imageAlt">
            </figure>
            <p class="story-citation-source">{{story.source}}</p>
            <h3>{{story.title}}</h3>
            <p>{{story.context}}</p>
            <p class="story-citation-ref">{{story.geomeCitation}}</p>
            <div class="story-citation-links">
              <a [href]="story.articleUrl" target="_blank" rel="noopener noreferrer">View article</a>
              <a [href]="story.doi" target="_blank" rel="noopener noreferrer">DOI</a>
            </div>
          </article>
        }

        <article class="story-photo-grid">
          <figure>
            <img [src]="featurePhotoTwo" alt="Field sample crate">
          </figure>
          <figure>
            <img [src]="featurePhotoThree" alt="Fish biodiversity photo">
          </figure>
        </article>
      </section>
    }
    @if(activePrototype === 'field' || activePrototype === 'ops'){
    <section class="feature-photos animate-in">
      <article class="feature-photo-card">
        <img [src]="featurePhotoOne" alt="Moorea coastline landscape">
      </article>
      <article class="feature-photo-card">
        <img [src]="featurePhotoTwo" alt="Moorea field crate">
      </article>
      <article class="feature-photo-card">
        <img [src]="featurePhotoThree" alt="Moorea fish reef">
      </article>
    </section>

    <section class="quote-ribbon animate-in">
      @for(item of activeQuotes; track item.quote){
        <article class="quote-card">
          <p class="quote-text">"{{item.quote}}"</p>
          <p class="quote-by">{{item.byline}}</p>
        </article>
      }
    </section>
    }

    <section class="link-cards animate-in">
      @for(item of homeItems; track item){
        <a class="link-card" [ngClass]="'tone-' + item.tone" [routerLink]="item.route">
          <div class="icon-wrap"><i [ngClass]="['fas', item.icon]"></i></div>
          <img [src]="item.img" [alt]="item.title">
          <h4>{{item.title}}</h4>
          <p>{{item.subtitle}}</p>
        </a>
      }
    </section>

    <section class="highlight-band animate-in">
      <article class="collab-highlight">
        <div class="collab-head">
          <h3>Open to Collaborate</h3>
          <span>Indigenous partnership and stewardship commitments</span>
        </div>
        <p>
          GEOME maintains this notice prominently to support new collaboration pathways and responsible data stewardship practices.
        </p>
        <button type="button" class="btn btn-light collab-btn" placement="top" ngbTooltip="Collaborate" (click)="openCollabModal(collab_modal)">
          <img src="images/Open_To_Collaborate.png" alt="Open to Collaborate" class="open-collab-icon" />
          <span>Review Collaboration Notice</span>
        </button>
      </article>

      <article class="publication-highlight">
        <h3>Foundational Publication</h3>
        <p>
          The Genomic Observatories Metadatabase (GEOME): A new repository for field and sampling event metadata associated with genetic samples.
        </p>
        <p class="authors">Deck J, Gaither MR, Ewing R, Bird CE, Davies N, Meyer C, Riginos C, Toonen RJ, Crandall ED.</p>
        <a href="https://doi.org/10.1371/journal.pbio.2002925" target="_blank" rel="noopener noreferrer">
          https://doi.org/10.1371/journal.pbio.2002925
        </a>
      </article>
    </section>

    <div class="legacy-link animate-in">
      <a href="https://geome-old.netlify.app/" target="_blank" rel="noopener noreferrer">Visit the Legacy GEOME Site</a>
    </div>
  </div>
</section>

<ng-template #collab_modal let-modal>
  <div class="modal-body p-4 pb-2">
    <h5 class="fw-semibold">Open to Collaborate</h5>
    <p>
      GEOME is committed to the development of new modes of collaboration, engagement, and partnership with Indigenous peoples for the care and stewardship of past and future heritage collections.
      See <a href="https://localcontexts.org/notice/open-to-collaborate/" target="_blank" class="text-decoration-none">Local Contexts</a> for more information
    </p>
    <div class="d-flex justify-content-end">
      <button type="button" class="btn btn-outline-primary border-0" (click)="modal.close()">Close</button>
    </div>
  </div>
</ng-template>
